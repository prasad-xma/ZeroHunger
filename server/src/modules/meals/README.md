# Meals Module Documentation

This module handles all meal-related operations for the ZeroHunger MERN application. It provides a complete CRUD API for managing meal data, including gallery display, detailed views, search functionality, and data validation.

## ğŸ“ Module Structure

```
meals/
â”œâ”€â”€ meal.model.js          # Mongoose schema and validations
â”œâ”€â”€ meal.controller.js     # Business logic for API endpoints
â”œâ”€â”€ meal.routes.js         # Express routes configuration
â”œâ”€â”€ meal.validators.js     # Custom validation functions
â””â”€â”€ README.md             # This documentation
```

## ğŸ—„ï¸ Model (meal.model.js)

Defines the MongoDB schema for Meal documents using Mongoose.

### Schema Fields

- **name** (String, required): Meal name (2-100 characters)
- **image** (String, required): Image URL (must be valid HTTP/HTTPS URL ending in .jpg/.jpeg/.png/.gif/.webp)
- **description** (String, required): Meal description (10-500 characters)
- **ingredients** (Array of Strings, required): List of ingredients (each 1-100 characters)
- **instructions** (Array of Strings, required): Cooking instructions (each 1-200 characters)
- **nutrition** (Object, required):
  - calories (Number, 0-10000)
  - protein (Number, 0-500)
  - carbs (Number, 0-1000)
  - fat (Number, 0-500)
- **createdAt/updatedAt** (Timestamps): Auto-generated by Mongoose

### Features

- Built-in Mongoose validations (required, min/max lengths, regex patterns)
- Automatic trimming of strings
- Timestamps for creation and update tracking

## ğŸ® Controller (meal.controller.js)

Contains all business logic for meal operations. Each function handles requests, validates data, interacts with the database, and returns standardized JSON responses.

### Functions

#### getAllMeals (GET /api/meals)
- Retrieves all meals from database
- Returns summary view for gallery grid (name, image, calories only)
- Response: `{ success: true, count: number, data: [meals] }`

#### getMeal (GET /api/meals/:id)
- Retrieves single meal by ID
- Returns full meal details
- Handles invalid ID and not found errors
- Response: `{ success: true, data: meal }`

#### createMeal (POST /api/meals)
- Creates new meal document
- Validates input data using custom validators
- Handles Mongoose validation errors
- Response: `{ success: true, message: "...", data: meal }`

#### updateMeal (PUT /api/meals/:id)
- Updates existing meal (partial updates allowed)
- Validates update data
- Handles invalid ID and not found errors
- Response: `{ success: true, message: "...", data: updatedMeal }`

#### deleteMeal (DELETE /api/meals/:id)
- Deletes meal by ID
- Handles invalid ID and not found errors
- Response: `{ success: true, message: "..." }`

#### searchMeals (GET /api/meals/search?q=value)
- Searches meals by name (case-insensitive)
- Returns summary view of matching meals
- Response: `{ success: true, count: number, data: [meals] }`

### Error Handling

All functions include comprehensive error handling:
- Database errors
- Validation failures
- Invalid ObjectIds
- Not found resources
- Standardized error responses: `{ success: false, message: "...", errors: [...] }`

## ğŸ›£ï¸ Routes (meal.routes.js)

Configures Express routes for the meals API. All routes are public (no authentication required).

### Route Mapping

| Method | Endpoint              | Controller Function | Description |
|--------|-----------------------|---------------------|-------------|
| GET    | /api/meals            | getAllMeals         | Get all meals (gallery view) |
| GET    | /api/meals/search     | searchMeals         | Search meals by name |
| GET    | /api/meals/:id        | getMeal             | Get single meal details |
| POST   | /api/meals            | createMeal          | Create new meal |
| PUT    | /api/meals/:id        | updateMeal          | Update existing meal |
| DELETE | /api/meals/:id        | deleteMeal          | Delete meal |

### Features

- Clean route organization
- Parameter extraction from req.params
- Consistent response formats

## âœ… Validators (meal.validators.js)

Custom validation functions to ensure data integrity before database operations.

### validateMealInput(body)
- Validates complete meal data for creation
- Checks all required fields with type and length validations
- Returns: `{ ok: boolean, errors: [strings], value: sanitizedData }`

### validateMealUpdateInput(body)
- Validates partial update data
- Allows optional fields
- Sanitizes and validates only provided fields
- Returns: `{ ok: boolean, errors: [strings], value: sanitizedData }`

### Validation Rules

- Strings: Non-empty, trimmed, length constraints
- Arrays: Non-empty, each item validated
- Numbers: Non-negative, reasonable max limits
- Custom error messages for each validation failure

## ğŸ”§ Usage Examples

### Creating a Meal (POST /api/meals)
```json
{
  "name": "Chicken Salad",
  "image": "https://example.com/chicken.jpg",
  "description": "Healthy chicken salad with fresh vegetables",
  "ingredients": ["Chicken breast", "Lettuce", "Tomatoes"],
  "instructions": ["Grill chicken", "Chop vegetables", "Mix together"],
  "nutrition": {
    "calories": 400,
    "protein": 35,
    "carbs": 20,
    "fat": 10
  }
}
```

### Search Query (GET /api/meals/search?q=chicken)
Returns meals with "chicken" in the name.

## ğŸ”— Integration

- Imported in `server.js` at `/api/meals`
- Uses Mongoose for database operations
- Follows project's error handling patterns
- Compatible with existing auth and nutrition modules

## ğŸ§ª Testing

Use Postman or similar to test endpoints:
- Base URL: `http://localhost:5000/api/meals`
- All endpoints return JSON with `success`, `message`, `data`, and optional `errors` fields
- Test with invalid data to verify validation

## ğŸ“ˆ Future Enhancements

- Add image upload functionality
- Implement meal categories/tags
- Add user favorites/ratings
- Pagination for large meal lists
- Advanced search filters (by nutrition, ingredients)


## Contributors

Maleesha Ransarani
GitHub: https://github.com/maleesharansarani

LinkedIn: https://www.linkedin.com/in/maleesha-ransarani

Portfolio: https://maleesha-portfolio.vercel.app


